Questions:
    1. What is the time period used?
    2. How many properties have duplicate entries? Remove duplicate rows (say a row
    appears 3 times, remove 2 and keep 1)
    3. For each property, find out the number of days the property was available and not
    available (create a table with listing_id, available days, unavailable days and available
    days as a fraction of total days)
    4. How many properties were available on more than 50% of the days? How many
    properties were available on more than 75% of the days?
    5. Create a table with max, min and average price of each property
    6. Extract properties with an average price of more than $500

Solution:
    1) 
    2) SELECT COUNT(*) - COUNT(DISTINCT listing_id, date, available, price )
        FROM dummy;
    3) SELECT (S
        SELECT COUNT(*) 
            FROM airbnb_calendar
            WHERE available = 't'
            GROUP BY listing_id
        ) AS AVAILABLE,
        (
            SELECT COUNT(*) 
            FROM airbnb_calendar
            WHERE available = 'f'
            GROUP BY listing_id
        ) AS UNAVAILABLE,
        UNAVAILABLE/365,
        AVAILABLE/365;
    4)
        a) SELECT listing_id, percent FROM (
            SELECT listing_id, (count(case when available = 't' then 1 end) / count(*)) * 100 AS PERCENT
            FROM airbnb_calendar
            GROUP BY listing_id
        ) AS temp WHERE percent > 50;

        b)  SELECT listing_id, percent from (
            SELECT listing_id, (count(case when available = 't' then 1 end) / count(*)) * 100 AS PERCENT
            FROM airbnb_calendar
            GROUP BY listing_id
        ) AS temp WHERE percent > 75;
    5) SELECT listing_id AS property, MAX(price) AS Max, MIN(price) AS Min, AVG(price) AS Average
        FROM airbnb_calendar
        GROUP BY listing_id;
    6) SELECT listing_id FROM (
            SELECT AVG(price) AS PRICE, listing_id
            FROM airbnb_calendar
            GROUP BY listing_id
        ) AS temp
        WHERE PRICE > 500;